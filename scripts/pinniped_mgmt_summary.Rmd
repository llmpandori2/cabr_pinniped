---
title: "Cabrillo National Monument Seals and Sea Lion Park Management Briefing"
author: "L. Pandori"
output: html_document
---

```{r setup}
knitr::opts_chunk$set(echo = F, message = F, warning = F)

##### load packages #####
library(gt)        # nice tables
library(viridis)   # color palette
library(lubridate) # dates/times
library(readxl)    # read excel files
library(janitor)   # clean data
library(tidyverse) # life

###### set themes #####
ll_theme <- theme_bw() + theme(text = element_text(size = 12),
                                    # add more space between panels
                                    panel.spacing = unit(1, 'lines'),
                                    # no background to wrap panels
                                    strip.background = element_blank(),
                                    strip.text = element_text(size = 12, 
                                                              hjust = 0),
                                    # panel labels outside x axis labels
                                    strip.placement = 'outside',
                                    # adjust x axis labels
                                    axis.text.y = element_text(size = 12),
                                    axis.text.x = element_text(size = 12, 
                                                               angle = 45, 
                                                               hjust = 1))

```

### Introduction

Cabrillo National Monument (CABR) is a unit of the National Park System located at the tip of Point Loma in San Diego, CA. Despite its small footprint (160 terrestrial acres), the monument attracts nearly one million visitors each year, 380,000 of which visited the coastal area of the park in 2020. Further, the *c.* 2.5 km stretch of shoreline in the coastal area of the park is used by seals and sea lions. This results in potential conflicts between conservation of natural resources, visitors, and other users of the area. Due to its value as both a habitat refuge and public resource, it is critical to monitor use patterns by visitors, seals and sea lions at Cabrillo National Monument.

### Objectives

The objective of this monitoring program is to provide estimates of seal, sea lion, and visitor use at three sites in the coastal area of Cabrillo National Monument from June 2021 thru January 2022. Specifically, this study: 

(1) Document trends in seal, sea lion and visitor use over time
(2) Identify preferred haul-out sites (places where seals and sea lions rest on land)
(3) Explore relationships between tidal and weather conditions on seal and sea lion abundance

### Results

```{r data prep}

# read in pinniped data
pin <- read_csv('../data/pinniped_summary.csv')

# get complete data without duplicates
pin <- pin %>%
          na.omit() %>%
          distinct()

```

#### Only harbor seals occupy the intertidal zone

Over 26 surveys, only  surveys, only three sea lions were observed. Due to this finding, analyses that follow consider only adult harbor seals. 

```{r totals of observations}

obs_table <- pin %>%
  select(vista:humans) %>%
  # pivot longer to do calculations on rows
  pivot_longer(., cols = int_seal_adult:humans, names_to = 'obs_type') %>%
  mutate(obs_type = case_when(grepl('lion', obs_type) ~ 'Sea lions',
                              grepl('seal', obs_type) ~ 'Seals',
                              TRUE ~ 'Visitors')) %>%
  group_by(vista, obs_type) %>%
  # get sum of each type
  summarize(n = sum(value)) %>%
  # pivot wider into a table with vista along the columns and type in rows
  pivot_wider(names_from = vista, values_from = n) %>%
  ungroup() %>%
  # nice names
  rename(`Zone 1` = zone1, `Spur Trail` = spur, `Lot 3` = lot3, `Observation type` = obs_type) %>%
  # reorder from S to N
  select(`Observation type` ,`Zone 1`, `Spur Trail`, `Lot 3`)



  gt(obs_table)

length(unique(pin$date))
  

```

#### Harbor seal abundance across vistas over time
While harbor seals were observed swimming in Zone I, there were no harbor seals observed in the intertidal at that vista. More adult harbor seals were observed at the Spur Trail and Lot 3 vistas. Since both vistas overlook a shared intertidal space, individuals may be counted twice. 
```{r fig.height = 5, echo = FALSE, message = FALSE, warning = FALSE}

pin <- filter(pin, year(dtime) > 2020) %>%
  # nice vista names
  mutate(vista = case_when(vista == 'lot3' ~ 'Lot 3',
                           vista == 'spur' ~ 'Spur Trail',
                           vista == 'zone1' ~ 'Zone 1'))
  

pin_plot <- ggplot(data = pin,
       mapping = aes(x = dtime, y = int_seal_adult, group = vista, color = vista)) + 
  geom_point(size = 2) + 
  scale_color_viridis(discrete = TRUE, begin = 0.3, end = 0.7) +
  xlab('Survey date') + 
  ylab('Adult seal abundance') + 
  facet_wrap(~vista) +
  ll_theme + 
  theme(legend.position = 'none')

plot(pin_plot)
  
```

##### Harbor seal abundance vs tide level
Since no harbor seals were observed in Zone 1, this analysis only includes data from the Spur Trail and Lot 3 vistas. 

There were more seals hauled out during higher tide periods. 

```{r fig.width = 5, fig.height = 3, echo = FALSE, message = FALSE, warning = FALSE}

pin2 <- filter(pin, vista != "Zone 1")

tide_plot <- ggplot(data = pin2,
                    mapping = aes(x = predicted_ft, y = int_seal_adult, 
                                  color = vista)) +
  geom_point(size = 2) + 
  scale_color_viridis(discrete = TRUE, begin = 0.3, end = 0.5) +
  xlab('Predicted tide level (ft above MLLW)') + 
  ylab('Adult seal abundance') + 
  facet_wrap(~vista) +
  ll_theme + 
  theme(legend.position = 'none')

plot(tide_plot)
```

#### Harbor seal abundance vs air temperature
There was no relationship between air temperature and seal abundance across vistas. There is also fewer air temperature data available, so only 8 survey dates are considered in this analysis. 

```{r fig.width = 5, fig.height = 3, echo = FALSE, message = FALSE, warning = FALSE}

temp_plot <- ggplot(data = pin2,
                    mapping = aes(x = sio_sst, y = int_seal_adult, 
                                  color = vista)) +
  geom_point(size = 2) + 
  scale_color_viridis(discrete = TRUE, begin = 0.3, end = 0.5) +
  xlab('Sea surface temperature (Â°C)') + 
  ylab('Adult seal abundance') + 
  facet_wrap(~vista) +
  ll_theme + 
  theme(legend.position = 'none')

plot(temp_plot)
```


### Methods Overview

California sea lions (*Zalophus californianus*) and harbor seals (*Phoca vitulina*) are the focal species of this sampling due to their high abundances and frequent haul-out, or land resting, behavior along southern California shores (Antonelis & Fiscus 1980). Volunteers in Parks (VIPs) conduct 10 minute observations of the numbers of seals and sea lions visible from three overlooks along the coastal area of the park (Zone 1, Spur Trail and Lot 3 overlooks). After conducting seal and sea lion observations, volunteers conduct 10 minute observations of the number of humans in the intertidal area. They record the time, estimated percent cloud cover, and subjective wind level (on a scale of 0-3) during surveys. The time of survey events is used to get the tide level, air temperature and water temperature from the National Oceanographic and Atmospheric Administration (NOAA) station at Scripps Pier in La Jolla. 